<!DOCTYPE html>
 <html>
  	<head>
    	<title>Problema2</title>
    	<script src="https://visualizacao-ufpe.github.io/data_vis_assignments/2018.1/datasetProblema2.js"></script>
    	<script type="text/javascript" src="https://d3js.org/d3.v5.js""></script>
    	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  		<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
   	</head>
   	<body>

   		<div id="controls">
  			<label for="year">Year:</label>
  			1990
  			<input type="range" id="year" min="1990" max="2017" value="2002"
    		 onchange="highlightYear(this.value)">
 			 2017
			</div>

   		<script type="text/javascript">


  

   			var height = 450

   			var svgContainer = d3.select("body")
 			.append("svg")
 			.attr("width", 600)
 			.attr("height", height)

 			var rect = svgContainer.selectAll("rect")
 			.data(dataset)
 			.enter()
 			.append("rect");

 			var rectAttributes = rect
 			.attr("x", function(d, index){ return index*50; })
 			.attr("y", function(d){ return (height - 7*d.books) - 40; })
 			.attr("height", function(d){ return 7*d.books; })
 			.attr("width", 40)
 			.text(function(d){ return d.year; })
 			.style("fill", function(d){
 				if (d.favoriteGenre == "romance"){
 					return '#fbb4ae'
 				}else if (d.favoriteGenre == "policial"){
 					return '#b3cde3' 
 				}else if (d.favoriteGenre == "biografia"){
 					return '#ccebc5'
 				}else if (d.favoriteGenre == "ficcao"){
 					return '#decbe4'
 				}else if (d.favoriteGenre == "conto"){
 					return '#fed9a6'
 				}else if (d.favoriteGenre == "cronica"){
 					return '#ffffcc'
 				}else if (d.favoriteGenre == "poesia"){
 					return '#e5d8bd'
 				}else{
 					return "black"
 				};

 			})
			var text = svgContainer.selectAll("#p")
           		.data(dataset)
           		.enter()
            	.append("text");

			var textLabels = text
				.attr("x", function(d, index){ return index*50 + 8; })
				.attr("y", function(d){ return (height - 7*d.books + 25) - 40; })
				.text(function(d){ return d.books; })
				.attr("font-family", "sans-serif")
				.attr("font-size", "20px")
				.attr("fill", "white");

			var text2 = svgContainer.selectAll("#yearText")
           		.data(dataset)
           		.enter()
            	.append("text");

			var textLabels2 = text2
				.attr("x", function(d, index){ return index*50 + 4; })
				.attr("y", function(d){ return height - 25; })
				.text(function(d){ return d.year; })
				.attr("font-family", "sans-serif")
				.attr("font-size", "15px")
				.attr("fill", "black");


			function highlightYear(value){

				//Pra limpar as outras bordas
				d3.select("body")
				.selectAll("rect")
				.style("stroke-width", 0);
				
				d3.select("body")
				.selectAll("rect")
  				.filter(function(){ 
   					return d3.select(this).text() == value
  				})
  				.style("stroke", "black")
  				.style("stroke-width", 5);

			}
   			
 	

   		</script>

  	</body>
</html>