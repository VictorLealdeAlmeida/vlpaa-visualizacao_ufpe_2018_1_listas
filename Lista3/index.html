<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Problema1</title>
	<script src="https://d3js.org/d3.v4.js"></script>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
	<script type="text/javascript">
		
		d3.json("geojs-100-mun.geojson", 
		    function (error, data){
			});

			var projection = d3.geoMercator()
			.translate([950, 100])
			.scale([700]);

			var path = d3.geoPath().projection(projection);


			d3.csv("oco.csv", function(data){
				
				var oco = data
				var freq = []
				var colors = {};

				oco.forEach(function(d) {
      			 	freq.push(d.ocorrencia_cidade);
    			});

    			freq = frequency(freq)
    			//console.log(freq[0])

    			freq[0].forEach(function(d,index){
    				colors[d] = freq[1][index]
    			});

    			console.log(colors)
    			

			 
			d3.json("geojs-100-mun.geojson", function(json){

				var svgContainer = d3.select("body")
 				.append("svg")
 				.attr("width", 1000)
 				.attr("height", 1000)

				svgContainer.selectAll("path")
				.data(json.features)
				.enter()
				.append("path")
				.attr("d", path)
				.attr("fill", function(d, index) {
					//console.log(index)

						//console.log(d['properties'].name.toUpperCase() + " + " + freq[0][index])
						
					if (colors[(d['properties'].name.toUpperCase())] == 1){
						return "red"
					}
				

					return "orange"})

				.style("stroke","white")
				.attr("stroke-width", 0.2)



			});
		});

	function frequency(arr) {
   		var a = [], b = [], prev;

    	arr.sort();
    	for ( var i = 0; i < arr.length; i++ ) {
	     	if ( arr[i] !== prev ) {
	        	a.push(arr[i]);
	         	b.push(1);
	       	} else {
	            b[b.length-1]++;
	       	}
	        prev = arr[i];
    	}

    	return [a, b];
	}


	</script>

</body>
</html>